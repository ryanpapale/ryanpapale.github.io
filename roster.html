<!DOCTYPE html>

<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title> Roster Optimization </title>
        <link rel = "stylesheet" href = "style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
    </head>

    <body>
        <header>
            Ryan Papale
            <nav>
                <a href = "index.html">Home</a>
                <a href = "baseball.html">Baseball</a>
                <a href = "economics.html">Economics</a> 
                <a href = "contact.html">Contact</a>  
            </nav>
        </header>

        <div class = "secname">
            Baseball
        </div>

        <main>
            <p style = "font-size: larger;">Lineup Optimization</p>
            <p>
                Suppose we have a 40-man roster and want to choose a starting lineup. Naturally, we want the players that will maximize our chances of winning. One way to approach 
                this is as an optimization problem. Suppose that we have some measure of each player's projected contribution, like wins above average. First, define a
                player's overall contribution as the sum of their offensive and a defensive component so that:
                \[WAA_{iph} = dWAA_{ip} + oWAA_{ih},\]
                where \(dWAA_{ip}\) is player \(i\)'s defensive contribution at position \(p\) and \(oWAA_{ih}\) is their offensive contribution against pitchers with 
                handedness \(h\). Their overall projected contribution is therefore \(WAA_{iph}\).
                <br><br>

                To set the optimal lineup assume that we are facing a RHP for simplicity and drop the \(h\) subscript. We wish to solve the following optimization problem:
                \[\max_{x_{ip}}\sum_{i}\sum_{p}WAA_{ip}x_{ip}\]
                \[s.t. \ \sum_{i}x_{ip} = 1 \ \forall p,\]
                \[\ \ \ \ \ \ \ \sum_{p}x_{ip} \leq 1 \ \forall i,\]
                \[\ \ \ \ \ \ \ \sum_{i}\sum_{p}x_{ip} = 9.\]
                \[\ \ \ \ \ \ \ x_{ip} \in \{0, 1\} \ \forall i, p,\]
            where \(i \in \{1, \ldots, N\}\) are the \(N\) position players on the 40-man roster and \(p \in \{1, \ldots,9\}\) indexes the position (including DH). 
            The choice variable \(x_{ip}\) is binary, such that:
                \[x_{ip}	 =
                \begin{cases}
                    1 & \text{if in lineup} \\
                    0 &\text{otherwise.}
                \end{cases} \]

            In words, what we want to do is set the 9-man lineup against RHPs to maximize total projected wins above average subject to roster constraints: one player per
            position, no player can appear more than once, and that we select nine players.
            <br><br>


            To solve for the optimal lineup, i.e., the lineup that maximizes total projected WAA for a given pitcher handedness, I use the Kuhn-Munkres algorithm. A brief overview 
            of the algorithm, it takes a matrix where rows are people and columns are jobs they can be assigned to. Elements of the matrix are the 
            costs associated with each person working in each job. The algorithm returns the worker/job assignments that minimize the total cost. 
            <br><br>


            For our purposes, to maximize total projected WAA, this algorithm can easily be reformulated as a maximization problem. There are several benefits to using this 
            algorithm. First, it naturally imposes the constraints from the maximization problem above. Second, it is quick and easy to use. Third, the solution is guaranteed to 
            be a global optimum under the assignment structure of the algorithm, although it may not be unique.
            <br><br>

            
            Below I present an example using the San Diego Padres. These numbers are not true projections; they are prorated statistics from the 2025 season intended for 
            demonstration purposes only. The table below shows the top of the dataframe used for the assignment algorithm. The first three columns are self-explanatory.
            The fourth column is players' defensive projections. The fifth and sixth columns are players' offensive projections against RHPs and LHPs, respectively.

                <pre><code class="language-r">head(padres, 10)</code></pre>

                <iframe 
                    src="tables/Layout.html" 
                    style="width: 100%; height: 450px; border: none;">
                </iframe>

            Using the data above, I then solve for the optimal lineup using the Kuhn-Munkres algorithm. In the table below I show the optimal lineup when 
            facing LHPs.

                <pre><code class="language-r">opt(padres, "l")</code></pre>

                <iframe 
                    src="tables/OptLHP.html" 
                    style="width: 100%; height: 450px; border: none;">
                </iframe>

            A relatively straightforward extension to this would be to incorporate uncertainty penalties into the objective function, allowing for risk-adjusted lineup selection.
            Additionally, positional adjustments have been omitted because they do not affect the optimal assignments. 
            
            Again, the data used here is illustrative rather than a genuine projection model.

            <br><br>
                
            The code to for this project can be found <a href = "https://github.com/ryanpapale/OptimalLineup" target="_blank">here.</a>
            </p>            
        </main>

        <footer>
            &copy; 2025 Ryan Papale
        </footer>
    </body>
</html>